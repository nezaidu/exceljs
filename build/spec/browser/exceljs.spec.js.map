{"version":3,"sources":["../../../spec/browser/exceljs.spec.js"],"names":["require","ExcelJS","unexpectedError","done","error","console","message","stack","expect","toEqual","describe","it","wb","Workbook","ws","addWorksheet","getCell","value","xlsx","writeBuffer","then","buffer","wb2","load","ws2","getWorksheet","toBeTruthy","catch","options","base64","toString","csv"],"mappings":"AAAA;;AAEAA,QAAQ,gBAAR;AACA,IAAIC,UAAUD,QAAQ,2BAAR,CAAd;;AAEA,SAASE,eAAT,CAAyBC,IAAzB,EAA+B;AAC7B,SAAO,UAASC,KAAT,EAAgB;AACrB;AACAC,YAAQD,KAAR,CAAc,cAAd,EAA8BA,MAAME,OAApC,EAA6CF,MAAMG,KAAnD;AACAC,WAAO,IAAP,EAAaC,OAAb,CAAqB,KAArB;AACAN;AACD,GALD;AAMD;;AAEDO,SAAS,SAAT,EAAoB,YAAW;AAC7BC,KAAG,8CAAH,EAAmD,UAASR,IAAT,EAAe;AAChE,QAAIS,KAAK,IAAIX,QAAQY,QAAZ,EAAT;AACA,QAAIC,KAAKF,GAAGG,YAAH,CAAgB,OAAhB,CAAT;;AAEAD,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,eAAzB;AACAH,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,CAAzB;;AAEAL,OAAGM,IAAH,CAAQC,WAAR,GACGC,IADH,CACQ,UAASC,MAAT,EAAiB;AACrB,UAAIC,MAAM,IAAIrB,QAAQY,QAAZ,EAAV;AACA,aAAOS,IAAIJ,IAAJ,CAASK,IAAT,CAAcF,MAAd,EACJD,IADI,CACC,YAAW;AACf,YAAII,MAAMF,IAAIG,YAAJ,CAAiB,OAAjB,CAAV;AACAjB,eAAOgB,GAAP,EAAYE,UAAZ;;AAEAlB,eAAOgB,IAAIR,OAAJ,CAAY,IAAZ,EAAkBC,KAAzB,EAAgCR,OAAhC,CAAwC,eAAxC;AACAD,eAAOgB,IAAIR,OAAJ,CAAY,IAAZ,EAAkBC,KAAzB,EAAgCR,OAAhC,CAAwC,CAAxC;AACAN;AACD,OARI,CAAP;AASD,KAZH,EAaGwB,KAbH,CAaS,UAASvB,KAAT,EAAgB;AACrB,YAAMA,KAAN;AACD,KAfH,EAgBGuB,KAhBH,CAgBSzB,gBAAgBC,IAAhB,CAhBT;AAiBD,GAxBD;AAyBAQ,KAAG,8CAAH,EAAmD,UAASR,IAAT,EAAe;AAChE,QAAIyB,UAAU;AACZC,cAAQ;AADI,KAAd;AAGA,QAAIjB,KAAK,IAAIX,QAAQY,QAAZ,EAAT;AACA,QAAIC,KAAKF,GAAGG,YAAH,CAAgB,OAAhB,CAAT;;AAEAD,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,eAAzB;AACAH,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,CAAzB;;AAEAL,OAAGM,IAAH,CAAQC,WAAR,CAAoBS,OAApB,EACGR,IADH,CACQ,UAASC,MAAT,EAAiB;AACrB,UAAIC,MAAM,IAAIrB,QAAQY,QAAZ,EAAV;AACA,aAAOS,IAAIJ,IAAJ,CAASK,IAAT,CAAcF,OAAOS,QAAP,CAAgB,QAAhB,CAAd,EAAyCF,OAAzC,EACJR,IADI,CACC,YAAW;AACf,YAAII,MAAMF,IAAIG,YAAJ,CAAiB,OAAjB,CAAV;AACAjB,eAAOgB,GAAP,EAAYE,UAAZ;;AAEAlB,eAAOgB,IAAIR,OAAJ,CAAY,IAAZ,EAAkBC,KAAzB,EAAgCR,OAAhC,CAAwC,eAAxC;AACAD,eAAOgB,IAAIR,OAAJ,CAAY,IAAZ,EAAkBC,KAAzB,EAAgCR,OAAhC,CAAwC,CAAxC;AACAN;AACD,OARI,CAAP;AASD,KAZH,EAaGwB,KAbH,CAaS,UAASvB,KAAT,EAAgB;AACrB,YAAMA,KAAN;AACD,KAfH,EAgBGuB,KAhBH,CAgBSzB,gBAAgBC,IAAhB,CAhBT;AAiBD,GA3BD;AA4BAQ,KAAG,6BAAH,EAAkC,UAASR,IAAT,EAAe;AAC/C,QAAIS,KAAK,IAAIX,QAAQY,QAAZ,EAAT;AACA,QAAIC,KAAKF,GAAGG,YAAH,CAAgB,OAAhB,CAAT;;AAEAD,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,eAAzB;AACAH,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,kBAAzB;AACAH,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,CAAzB;AACAH,OAAGE,OAAH,CAAW,IAAX,EAAiBC,KAAjB,GAAyB,MAAzB;;AAEAL,OAAGmB,GAAH,CAAOZ,WAAP,GACGC,IADH,CACQ,UAASC,MAAT,EAAiB;AACrBb,aAAOa,OAAOS,QAAP,EAAP,EAA0BrB,OAA1B,CAAkC,0CAAlC;AACAN;AACD,KAJH,EAKGwB,KALH,CAKS,UAASvB,KAAT,EAAgB;AACrB,YAAMA,KAAN;AACD,KAPH,EAQGuB,KARH,CAQSzB,gBAAgBC,IAAhB,CART;AASD,GAlBD;AAmBD,CAzED","file":"exceljs.spec.js","sourcesContent":["'use strict';\n\nrequire('babel-polyfill');\nvar ExcelJS = require('../../lib/exceljs.browser');\n\nfunction unexpectedError(done) {\n  return function(error) {\n    // eslint-disable-next-line no-console\n    console.error('Error Caught', error.message, error.stack);\n    expect(true).toEqual(false);\n    done();\n  };\n}\n\ndescribe('ExcelJS', function() {\n  it('should read and write xlsx via binary buffer', function(done) {\n    var wb = new ExcelJS.Workbook();\n    var ws = wb.addWorksheet('blort');\n\n    ws.getCell('A1').value = 'Hello, World!';\n    ws.getCell('A2').value = 7;\n\n    wb.xlsx.writeBuffer()\n      .then(function(buffer) {\n        var wb2 = new ExcelJS.Workbook();\n        return wb2.xlsx.load(buffer)\n          .then(function() {\n            var ws2 = wb2.getWorksheet('blort');\n            expect(ws2).toBeTruthy();\n\n            expect(ws2.getCell('A1').value).toEqual('Hello, World!');\n            expect(ws2.getCell('A2').value).toEqual(7);\n            done();\n          });\n      })\n      .catch(function(error) {\n        throw error;\n      })\n      .catch(unexpectedError(done));\n  });\n  it('should read and write xlsx via base64 buffer', function(done) {\n    var options = {\n      base64: true\n    };\n    var wb = new ExcelJS.Workbook();\n    var ws = wb.addWorksheet('blort');\n\n    ws.getCell('A1').value = 'Hello, World!';\n    ws.getCell('A2').value = 7;\n\n    wb.xlsx.writeBuffer(options)\n      .then(function(buffer) {\n        var wb2 = new ExcelJS.Workbook();\n        return wb2.xlsx.load(buffer.toString('base64'), options)\n          .then(function() {\n            var ws2 = wb2.getWorksheet('blort');\n            expect(ws2).toBeTruthy();\n\n            expect(ws2.getCell('A1').value).toEqual('Hello, World!');\n            expect(ws2.getCell('A2').value).toEqual(7);\n            done();\n          });\n      })\n      .catch(function(error) {\n        throw error;\n      })\n      .catch(unexpectedError(done));\n  });\n  it('should write csv via buffer', function(done) {\n    var wb = new ExcelJS.Workbook();\n    var ws = wb.addWorksheet('blort');\n\n    ws.getCell('A1').value = 'Hello, World!';\n    ws.getCell('B1').value = 'What time is it?';\n    ws.getCell('A2').value = 7;\n    ws.getCell('B2').value = '12pm';\n\n    wb.csv.writeBuffer()\n      .then(function(buffer) {\n        expect(buffer.toString()).toEqual('\"Hello, World!\",What time is it?\\n7,12pm')\n        done();\n      })\n      .catch(function(error) {\n        throw error;\n      })\n      .catch(unexpectedError(done));\n  });\n});\n"]}